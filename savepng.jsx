var docRef = app.activeDocumentdocRef.selection.selectAll()docRef.selection.copy (true)var newDoc = app.documents.add (1000, 1000, 72, "test", NewDocumentMode.RGB, DocumentFill.TRANSPARENT, 1.0, BitsPerChannelType.EIGHT)newDoc.paste (false)var pngName = prompt ("enter file name", "", "")var docPath = docRef.path+'/' + pngName +'@2x.png'SavePNG(newDoc ,docPath)var oldUnits = app.preferences.rulerUnitsapp.preferences.rulerUnits = Units.PERCENT;activeDocument.resizeImage(50, undefined, undefined, ResampleMethod.BICUBIC);var docPath = docRef.path+'/' + pngName +'.png'SavePNG(newDoc ,docPath)app.preferences.rulerUnits = oldUnits;newDoc.close (SaveOptions.DONOTSAVECHANGES)function SavePNG(doc, saveFile){    //alert (saveFile, "path", null)     pngFile = new File(saveFile);    doc.trim(TrimType.TRANSPARENT, true , true, true , true)    var pngOpts = new ExportOptionsSaveForWeb;     pngOpts.format = SaveDocumentType.PNG    pngOpts.PNG8 = false;     pngOpts.transparency = true;     pngOpts.interlaced = false;       pngOpts.quality = 100;    doc.exportDocument (pngFile, ExportType.SAVEFORWEB, pngOpts)}